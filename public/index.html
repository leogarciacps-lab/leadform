<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Get Your Free Estimate</title>

<link href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-1.10.1.min.js"></script>

<style>
body {
    background-color: #eef3f9;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 40px;
}

.container {
    max-width: 560px;
    background: #ffffff;
    padding: 32px 40px;
    border-radius: 12px;
    box-shadow: 0 14px 30px rgba(0,0,0,0.15);
    margin: auto;
    border-top: 6px solid #1f6fd6;
}

h2 {
    text-align: center;
    font-weight: 700;
    color: #1f6fd6;
    margin-bottom: 25px;
}

input[type="text"],
input[type="email"] {
    width: 100%;
    padding: 12px 14px;
    margin-bottom: 14px;
    border: 1px solid #ccc;
    border-radius: 6px;
}

input:focus {
    border-color: #1f6fd6;
    box-shadow: 0 0 6px rgba(31,111,214,0.4);
    outline: none;
}

#consentText {
    border: 1px solid #d6e2f3;
    border-radius: 6px;
    padding: 12px;
    background-color: #f5f9ff;
    font-size: 13px;
    line-height: 1.4;
    margin-top: 10px;
}

#consentLoading {
    font-size: 13px;
    color: #666;
    margin-top: 10px;
}

.consent-checkbox {
    margin-top: 12px;
}

.consent-checkbox label {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    font-size: 14px;
    line-height: 1.4;
    cursor: pointer;
}

.consent-checkbox input[type="checkbox"] {
    margin-top: 2px;
}

.btn-submit {
    width: 100%;
    background: #1f6fd6;
    border: none;
    padding: 14px;
    border-radius: 6px;
    font-size: 16px;
    color: white;
    font-weight: 700;
    margin-top: 18px;
}

.btn-submit:disabled {
    background: #9cbbe9;
    cursor: not-allowed;
}
</style>
</head>

<body>

<div class="container">
    <h2>Get Your Free Estimate</h2>

<form id="leadForm">

    <!-- Hidden TCPA fields -->
    <input type="hidden" id="consentTextIPAddress" name="IPAddress">
    <input type="hidden" id="ConsentGiven" name="ConsentGiven" value="No">
    <input type="hidden" id="ConsentTextHidden" name="ConsentText">
    <input type="hidden" name="UserAgent">

    <!-- Lead fields -->
    <input type="text" name="firstName" placeholder="First Name" required>
    <input type="text" name="lastName" placeholder="Last Name" required>
    <input type="email" name="email" placeholder="Email Address" required>
    <input type="text" name="phone" placeholder="Phone Number">
    <input type="text" name="zip" placeholder="ZIP Code">

    <!-- Consent -->
    <p id="consentLoading">Loading consent textâ€¦</p>
    <div id="consentText"></div>

    <div class="consent-checkbox">
        <label for="consentCheckbox">
            <input type="checkbox" id="consentCheckbox" required>
            <span>I have read and agree to the consent language above.</span>
        </label>
    </div>

    <button type="submit" class="btn-submit" id="submitBtn" disabled>
        Submit
    </button>
</form>
</div>

<!-- LeadExec Consent Provider -->
<script type="text/javascript">
const consentKey = '451ed5df-9b50-4512-acd4-c21daea3471d';
const consentTextAppendMode = 'replace';
const consentTextLoadOnPageLoad = true;
const consentTextElementName = 'consentText';
const consentTextIPElementName = 'consentTextIPAddress';

(function () {
    var consentJs = document.createElement('script');
    consentJs.type = 'text/javascript';
    consentJs.async = true;
    consentJs.src =
        (document.location.protocol === 'https:' ? 'https://' : 'http://') +
        'consentprovider.leadexec.net/scripts/requestJS.min.js';

    var consentS = document.getElementsByTagName('script')[0];
    consentS.parentNode.insertBefore(consentJs, consentS);
})();
</script>

<script>
// Hide loading text once consent loads
const consentWatcher = setInterval(() => {
    const consentDiv = document.getElementById('consentText');
    if (consentDiv && consentDiv.innerText.trim().length > 30) {
        document.getElementById('consentLoading').style.display = 'none';
        clearInterval(consentWatcher);
    }
}, 300);

// Enable submit only when checkbox is checked
document.getElementById('consentCheckbox').addEventListener('change', function () {
    document.getElementById('submitBtn').disabled = !this.checked;
});

// Submit handler
$('#leadForm').on('submit', function (e) {
    e.preventDefault();

    if (!$('#consentCheckbox').is(':checked')) return;

    $('#ConsentGiven').val('Yes');
    $('#ConsentTextHidden').val($('#consentText').text());
    $('input[name="UserAgent"]').val(navigator.userAgent);

    $.ajax({
        url: '/submit-form',
        type: 'POST',
        data: $('#leadForm').serialize(),
        success: function () {
            alert('Lead submitted successfully!');
            location.reload();
        },
        error: function () {
            alert('Error submitting lead.');
        }
    });
});
</script>

</body>
</html>
